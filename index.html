<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hoja de Vida ‚Äì Persona Jur√≠dica</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>Hoja de Vida ‚Äì Persona Jur√≠dica</h1>
    <div class="main-container">
      <form id="form">
        <!-- I. IDENTIFICACI√ìN -->
        <fieldset>
          <legend>
            I. Identificaci√≥n
            <button type="button" class="collapse-btn">‚àí</button>
          </legend>
          <input
            name="razonSocial"
            placeholder="Raz√≥n social"
            value="fundacion para el desarrollo social"
          />
          <input name="sigla" placeholder="Sigla" value="FUDES" />
          <input name="nit" placeholder="NIT" value="123581" />
          <label for="orden">Determinar el orden</label>
          <select name="orden" id="orden">
            <option value="" selected>Seleccionar...</option>
            <option value="nal">Nacional</option>
            <option value="dptl">Departamental</option>
            <option value="dstr">Distrital</option>
            <option value="mpl">Municipal</option>
            <option value="otro">Otro</option>
          </select>
          <!-- Si se selecciona "Otro", mostrar este campo para especificar cu√°l -->
          <input
            type="text"
            name="ordenCual"
            placeholder="Si es otro, ¬øCu√°l?"
          />
          <label for="tipo">Determinar el tipo</label>
          <select name="tipo" id="tipo">
            <option value="" selected>Seleccionar...</option>
            <option value="01">01. MDA</option>
            <option value="02">02. SUA</option>
            <option value="03">03. EP</option>
            <option value="04">04. EUA/ESE</option>
            <option value="05">05. EICE</option>
            <option value="06">06. SEM</option>
            <option value="08">08. OTRO</option>
          </select>
          <label for="clase">Determinar la clase</label>
          <select name="clase" id="clase">
            <option value="" selected>Seleccionar...</option>
            <option value="11">11. SCIF</option>
            <option value="12">12. SSAL</option>
            <option value="13">13. SC</option>
            <option value="14">14. ONG</option>
            <option value="15">15. SE</option>
            <option value="16">16. OTRA</option>
          </select>
          <label for="domicilioCorrespondencia"
            >Domicilio para correspondencia</label
          >
          <input type="text" name="pais" placeholder="Pa√≠s" value="Colombia" />
          <input
            type="text"
            name="departamento"
            placeholder="Departamento"
            value="Cordoba"
          />
          <input
            type="text"
            name="municipio"
            placeholder="Municipio"
            value="Monter√≠a"
          />
          <input
            type="text"
            name="direccion"
            placeholder="Direccion"
            value="Calle 25 nro 3 45"
          />
          <input
            type="text"
            name="telefonos"
            placeholder="Tel√©fonos"
            value="320 440 3165"
          />
          <input
            type="text"
            name="fax"
            placeholder="Fax"
            value="320 440 3165"
          />
          <input
            type="text"
            name="apartadoAereo"
            placeholder="Apartado A√©reo"
            value="320 440 3165"
          />
        </fieldset>
        <!-- II. SERVICIOS -->
        <fieldset>
          <legend>
            II. Servicios <button type="button" class="collapse-btn">‚àí</button>
          </legend>
          <input
            name="servicio1"
            placeholder="Servicio 1"
            value="Prestaci√≥n de servicios"
          />
          <input
            name="servicio2"
            placeholder="Servicio 2"
            value="Prestaci√≥n de servicios"
          />
          <input
            name="servicio3"
            placeholder="Servicio 3"
            value="Prestaci√≥n de servicios"
          />
          <input
            name="servicio4"
            placeholder="Servicio 4"
            value="Prestaci√≥n de servicios"
          />
          <input
            name="servicio5"
            placeholder="Servicio 5"
            value="Prestaci√≥n de servicios"
          />
          <input
            name="servicio6"
            placeholder="Servicio 6"
            value="Prestaci√≥n de servicios"
          />
        </fieldset>
        <!-- III. EXPERIENCIA  O SITUACION ACTUAL -->
        <fieldset>
          <legend>
            III. Experiencia o Situaci√≥n Actual
            <button type="button" class="collapse-btn">‚àí</button>
          </legend>
          <input name="primerApellido" placeholder="Primer apellido" />
          <input name="segundoApellido" placeholder="Segundo apellido" />
          <input name="nombres" placeholder="Nombres" />
          <input name="documento" placeholder="Documento" />
        </fieldset>
        <!-- IV. REPRESENTANTE -->
        <fieldset>
          <legend>
            IV. Representante Legal
            <button type="button" class="collapse-btn">‚àí</button>
          </legend>
          <input name="primerApellido" placeholder="Primer apellido" />
          <input name="segundoApellido" placeholder="Segundo apellido" />
          <input name="nombres" placeholder="Nombres" />
          <input name="documento" placeholder="Documento" />
        </fieldset>
        <div class="fixed-actions">
          <button type="submit">üìÑ Generar PDF</button>
          <button type="button" id="btn-preview">üëÅÔ∏è Vista Previa</button>
        </div>
      </form>
      <!-- Canvas oculto: para renderizar PDF con PDF.js -->
      <canvas id="pdf-canvas-hidden" style="display: none"></canvas>

      <div class="preview-container canvas-wrapper">
        <!-- Canvas visible: para mostrar preview en escritorio -->
        <canvas
          id="pdf-preview"
          style="
            border: 1px solid #333;
            background: #fff;
            box-shadow: 0 2px 8px #0002;
          "
        ></canvas>
        <div style="font-size: 13px; color: #333; margin-top: 8px">
          Vista previa plantilla.pdf
        </div>
      </div>
    </div>

    <!-- Modal para vista previa en m√≥vil -->
    <div id="modal-overlay" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <span>Vista Previa</span>
          <button type="button" class="modal-close-btn">√ó</button>
        </div>
        <canvas
          id="pdf-preview-mobile"
          style="
            border: 1px solid #333;
            background: #fff;
            box-shadow: 0 2px 8px #0002;
            width: 100%;
            display: block;
          "
        ></canvas>
        <div
          style="
            font-size: 13px;
            color: #333;
            margin-top: 8px;
            text-align: center;
          "
        >
          Vista previa plantilla.pdf
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js"></script>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="app.js"></script>
    <script>
      // L√≥gica del modal para vista previa en m√≥vil
      const btnPreview = document.getElementById("btn-preview");
      const modalOverlay = document.getElementById("modal-overlay");
      const modalCloseBtn = document.querySelector(".modal-close-btn");
      const isMobile = () => window.innerWidth <= 768;

      // Abrir modal en m√≥vil
      btnPreview.addEventListener("click", (e) => {
        if (isMobile()) {
          e.preventDefault();
          modalOverlay.classList.add("active");
          // Copiar el contenido del canvas principal al modal
          const mainCanvas = document.getElementById("pdf-preview");
          const mobileCanvas = document.getElementById("pdf-preview-mobile");
          const ctx = mobileCanvas.getContext("2d");
          if (mainCanvas.width > 0 && mainCanvas.height > 0) {
            mobileCanvas.width = mainCanvas.width;
            mobileCanvas.height = mainCanvas.height;
            ctx.drawImage(mainCanvas, 0, 0);
          }
        }
      });

      // Cerrar modal
      const closeModal = () => {
        modalOverlay.classList.remove("active");
      };

      modalCloseBtn.addEventListener("click", closeModal);
      modalOverlay.addEventListener("click", (e) => {
        if (e.target === modalOverlay) closeModal();
      });

      // Cerrar modal con Esc
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && modalOverlay.classList.contains("active")) {
          closeModal();
        }
      });

      // Colapsar todos los fieldsets excepto el primero y cambiar el icono
      const fieldsets = document.querySelectorAll("form fieldset");
      fieldsets.forEach((fieldset, idx) => {
        const btn = fieldset.querySelector(".collapse-btn");
        const content = Array.from(fieldset.children).filter(
          (el) => el.tagName !== "LEGEND",
        );
        if (idx === 0) {
          // El primero queda expandido
          content.forEach((el) => (el.style.display = ""));
          btn.textContent = "‚ñ≤";
        } else {
          // Los dem√°s colapsados
          content.forEach((el) => (el.style.display = "none"));
          btn.textContent = "‚ñº";
        }
        btn.addEventListener("click", function () {
          if (btn.textContent === "‚ñ≤") {
            content.forEach((el) => (el.style.display = "none"));
            btn.textContent = "‚ñº";
          } else {
            content.forEach((el) => (el.style.display = ""));
            btn.textContent = "‚ñ≤";
          }
        });
      });
    </script>
  </body>
</html>
